{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback } from 'react';\nimport tq from '../persona';\nfunction useChat() {\n  _s();\n  const [chats, setChats] = useState(() => {\n    try {\n      const savedChats = localStorage.getItem('chats');\n      if (savedChats) {\n        return JSON.parse(savedChats);\n      }\n    } catch (error) {\n      console.error(\"Failed to load chats from localStorage:\", error);\n    }\n    return [{\n      name: 'New Chat',\n      chatHistory: [],\n      persona: tq\n    }];\n  });\n  const [selectedChatIndex, setSelectedChatIndex] = useState(() => {\n    try {\n      const savedIndex = localStorage.getItem('selectedChatIndex');\n      if (savedIndex !== null) {\n        const index = Number(savedIndex);\n        if (index >= 0 && index < chats.length) {\n          return index;\n        }\n      }\n    } catch (error) {\n      console.error(\"Failed to load selectedChatIndex from localStorage:\", error);\n    }\n    return 0;\n  });\n  const saveChats = useCallback(() => {\n    try {\n      localStorage.setItem('chats', JSON.stringify(chats));\n      console.log(\"Saved chats to localStorage\");\n    } catch (error) {\n      console.error(\"Failed to save chats to localStorage:\", error);\n    }\n  }, [chats]);\n  const saveSelectedChatIndex = useCallback(() => {\n    try {\n      localStorage.setItem('selectedChatIndex', selectedChatIndex.toString());\n      console.log(\"Saved selectedChatIndex to localStorage:\", selectedChatIndex);\n    } catch (error) {\n      console.error(\"Failed to save selectedChatIndex to localStorage:\", error);\n    }\n  }, [selectedChatIndex]);\n  useEffect(() => {\n    saveChats();\n  }, [chats, saveChats]);\n  useEffect(() => {\n    saveSelectedChatIndex();\n  }, [selectedChatIndex, saveSelectedChatIndex]);\n  return {\n    chats,\n    setChats,\n    selectedChatIndex,\n    setSelectedChatIndex,\n    saveChats,\n    saveSelectedChatIndex\n  };\n}\n_s(useChat, \"CiPdSI3hcSifF4ZXttsiY4pXx+g=\");\nexport default useChat;","map":{"version":3,"names":["useState","useEffect","useCallback","tq","useChat","_s","chats","setChats","savedChats","localStorage","getItem","JSON","parse","error","console","name","chatHistory","persona","selectedChatIndex","setSelectedChatIndex","savedIndex","index","Number","length","saveChats","setItem","stringify","log","saveSelectedChatIndex","toString"],"sources":["/home/aldan/Desktop/projects/Lush Void/tokenquill/github/TulpaTalk/src/hooks/useChat.js"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport tq from '../persona';\n\nfunction useChat() {\n  const [chats, setChats] = useState(() => {\n    try {\n      const savedChats = localStorage.getItem('chats');\n      if (savedChats) {\n        return JSON.parse(savedChats);\n      }\n    } catch (error) {\n      console.error(\"Failed to load chats from localStorage:\", error);\n    }\n    return [{ name: 'New Chat', chatHistory: [], persona: tq }];\n  });\n\n  const [selectedChatIndex, setSelectedChatIndex] = useState(() => {\n    try {\n      const savedIndex = localStorage.getItem('selectedChatIndex');\n      if (savedIndex !== null) {\n        const index = Number(savedIndex);\n        if (index >= 0 && index < chats.length) {\n          return index;\n        }\n      }\n    } catch (error) {\n      console.error(\"Failed to load selectedChatIndex from localStorage:\", error);\n    }\n    return 0;\n  });\n\n  const saveChats = useCallback(() => {\n    try {\n      localStorage.setItem('chats', JSON.stringify(chats));\n      console.log(\"Saved chats to localStorage\");\n    } catch (error) {\n      console.error(\"Failed to save chats to localStorage:\", error);\n    }\n  }, [chats]);\n\n  const saveSelectedChatIndex = useCallback(() => {\n    try {\n      localStorage.setItem('selectedChatIndex', selectedChatIndex.toString());\n      console.log(\"Saved selectedChatIndex to localStorage:\", selectedChatIndex);\n    } catch (error) {\n      console.error(\"Failed to save selectedChatIndex to localStorage:\", error);\n    }\n  }, [selectedChatIndex]);\n\n  useEffect(() => {\n    saveChats();\n  }, [chats, saveChats]);\n\n  useEffect(() => {\n    saveSelectedChatIndex();\n  }, [selectedChatIndex, saveSelectedChatIndex]);\n\n  return { chats, setChats, selectedChatIndex, setSelectedChatIndex, saveChats, saveSelectedChatIndex };\n}\n\nexport default useChat;\n"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AACxD,OAAOC,EAAE,MAAM,YAAY;AAE3B,SAASC,OAAOA,CAAA,EAAG;EAAAC,EAAA;EACjB,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGP,QAAQ,CAAC,MAAM;IACvC,IAAI;MACF,MAAMQ,UAAU,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAChD,IAAIF,UAAU,EAAE;QACd,OAAOG,IAAI,CAACC,KAAK,CAACJ,UAAU,CAAC;MAC/B;IACF,CAAC,CAAC,OAAOK,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,yCAAyC,EAAEA,KAAK,CAAC;IACjE;IACA,OAAO,CAAC;MAAEE,IAAI,EAAE,UAAU;MAAEC,WAAW,EAAE,EAAE;MAAEC,OAAO,EAAEd;IAAG,CAAC,CAAC;EAC7D,CAAC,CAAC;EAEF,MAAM,CAACe,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGnB,QAAQ,CAAC,MAAM;IAC/D,IAAI;MACF,MAAMoB,UAAU,GAAGX,YAAY,CAACC,OAAO,CAAC,mBAAmB,CAAC;MAC5D,IAAIU,UAAU,KAAK,IAAI,EAAE;QACvB,MAAMC,KAAK,GAAGC,MAAM,CAACF,UAAU,CAAC;QAChC,IAAIC,KAAK,IAAI,CAAC,IAAIA,KAAK,GAAGf,KAAK,CAACiB,MAAM,EAAE;UACtC,OAAOF,KAAK;QACd;MACF;IACF,CAAC,CAAC,OAAOR,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,qDAAqD,EAAEA,KAAK,CAAC;IAC7E;IACA,OAAO,CAAC;EACV,CAAC,CAAC;EAEF,MAAMW,SAAS,GAAGtB,WAAW,CAAC,MAAM;IAClC,IAAI;MACFO,YAAY,CAACgB,OAAO,CAAC,OAAO,EAAEd,IAAI,CAACe,SAAS,CAACpB,KAAK,CAAC,CAAC;MACpDQ,OAAO,CAACa,GAAG,CAAC,6BAA6B,CAAC;IAC5C,CAAC,CAAC,OAAOd,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,uCAAuC,EAAEA,KAAK,CAAC;IAC/D;EACF,CAAC,EAAE,CAACP,KAAK,CAAC,CAAC;EAEX,MAAMsB,qBAAqB,GAAG1B,WAAW,CAAC,MAAM;IAC9C,IAAI;MACFO,YAAY,CAACgB,OAAO,CAAC,mBAAmB,EAAEP,iBAAiB,CAACW,QAAQ,CAAC,CAAC,CAAC;MACvEf,OAAO,CAACa,GAAG,CAAC,0CAA0C,EAAET,iBAAiB,CAAC;IAC5E,CAAC,CAAC,OAAOL,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,mDAAmD,EAAEA,KAAK,CAAC;IAC3E;EACF,CAAC,EAAE,CAACK,iBAAiB,CAAC,CAAC;EAEvBjB,SAAS,CAAC,MAAM;IACduB,SAAS,CAAC,CAAC;EACb,CAAC,EAAE,CAAClB,KAAK,EAAEkB,SAAS,CAAC,CAAC;EAEtBvB,SAAS,CAAC,MAAM;IACd2B,qBAAqB,CAAC,CAAC;EACzB,CAAC,EAAE,CAACV,iBAAiB,EAAEU,qBAAqB,CAAC,CAAC;EAE9C,OAAO;IAAEtB,KAAK;IAAEC,QAAQ;IAAEW,iBAAiB;IAAEC,oBAAoB;IAAEK,SAAS;IAAEI;EAAsB,CAAC;AACvG;AAACvB,EAAA,CAvDQD,OAAO;AAyDhB,eAAeA,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}